<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Five Queens Jewelry</title>
  <meta name="description" content="Five Queens Jewelry — demo e-commerce jewelry store with shipping + payments (GCash/PayMaya) and admin order management." />
  <link href="https://fonts.googleapis.com/css?family=Inter:400,600,700&display=swap" rel="stylesheet" />
  <style>
    :root{
      --accent:#b76e79; --muted:#6b6b6b; --card:#fff; --shadow:0 6px 24px rgba(16,24,40,0.08);
      --max:1100px; --gap:16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:'Inter',Arial,sans-serif;background:linear-gradient(180deg,#fff 0%, #fffdfb 100%)}
    .container{max-width:var(--max);margin:0 auto;padding:18px}
    header{position:sticky;top:0;background:rgba(255,255,255,0.96);backdrop-filter:blur(6px);box-shadow:var(--shadow);z-index:40}
    .nav{height:64px;display:flex;align-items:center;gap:14px;padding:8px 18px}
    .brand{display:flex;align-items:center;gap:14px;font-weight:700}
    .logo{width:44px;height:44px;border-radius:10px;overflow:hidden;display:flex;align-items:center;justify-content:center}
    .search{flex:1}
    .search input{width:100%;padding:10px 12px;border-radius:10px;border:1px solid #eee}
    .icons{display:flex;gap:8px;align-items:center}
    .icon-btn{padding:8px 12px;border-radius:10px;border:1px solid #eee;background:white;font-weight:600;cursor:pointer}
    main{padding:18px}
    .grid{display:grid;grid-template-columns:320px 1fr;gap:var(--gap)}
    @media(max-width:900px){.grid{grid-template-columns:1fr}}
    .aside{background:var(--card);border-radius:12px;padding:12px;box-shadow:var(--shadow)}
    .card{background:var(--card);border-radius:12px;padding:12px;box-shadow:var(--shadow);margin-bottom:18px}
    .products{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    @media(max-width:1100px){.products{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:600px){.products{grid-template-columns:1fr}}
    .product{border-radius:12px;overflow:hidden;border:1px solid #f0eaea;background:linear-gradient(180deg,#fff,#fffdfb)}
    .product .image{height:220px;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#fff,#fff7f9)}
    .product .body{padding:12px}
    .price{font-weight:700;color:var(--accent);font-size:17px}
    .meta{font-size:13px;color:var(--muted)}
    .btn{display:inline-block;padding:8px 12px;border-radius:10px;border:0;background:var(--accent);color:white;cursor:pointer;font-weight:600}
    .chip{padding:7px 13px;border-radius:999px;border:1px solid #eee;background:#fff;cursor:pointer;margin:2px;font-size:13px}
    .cart-drawer{position:fixed;right:18px;bottom:18px;width:360px;border-radius:14px;background:linear-gradient(180deg,#fff,#fffdfb);box-shadow:0 20px 50px rgba(10,10,10,0.09);padding:20px 18px;display:none;z-index:100}
    .cart-item{display:flex;gap:12px;align-items:center;padding:8px 0;border-bottom:1px dashed #f3eaea}
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.44);display:none;align-items:center;justify-content:center;padding:20px;z-index:500}
    .modal{background:var(--card);border-radius:12px;max-width:920px;width:100%;box-shadow:var(--shadow);overflow:hidden}
    .modal .content{padding:18px}
    .muted{color:var(--muted);font-size:13px}
    footer{padding:30px 0;text-align:center;color:var(--muted)}
    @media(max-width:600px){
      header .nav{flex-direction:column;gap:12px}
      .modal{width:96%}
    }

    /* Checkout/small styles */
    .field{margin-bottom:12px}
    .field label{display:block;font-size:13px;font-weight:600;margin-bottom:6px}
    .field input[type="text"], .field input[type="tel"], .field textarea, .field input[type="file"]{width:100%;padding:10px;border-radius:8px;border:1px solid #eee}
    .receipt-preview{max-width:100%;border-radius:8px;margin-top:8px;border:1px solid #eee}
    .order-row{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px dashed #eee}
    .status-pill{padding:6px 10px;border-radius:999px;font-weight:600}
    .status-pending{background:#fff3f3;color:#b76e79;border:1px solid #f2cbd1}
    .status-paid{background:#f3fff8;color:#1b8f4a;border:1px solid #c8efd7}
    .status-delivered{background:#f3f7ff;color:#1b4db8;border:1px solid #d7e3ff}
    .small-muted{font-size:12px;color:var(--muted)}
    .btn-sm{padding:6px 8px;border-radius:8px;font-size:13px}
  </style>
</head>
<body>
  <header>
    <div class="nav container">
      <div class="brand">
        <div class="logo"><img src="logo.png" alt="logo" style="width:44px;height:44px;object-fit:cover"></div>
        <div>
          <div style="font-size:15px">Five Queens Jewelry</div>
          <div style="font-size:12px;color:var(--muted)">Shine With the Elegance of a Queen</div>
        </div>
      </div>

      <div class="search" style="margin-left:8px">
        <input id="searchInput" placeholder="Search products..." />
      </div>

      <div style="flex:0 0 auto"></div>
      <div class="icons">
        <div class="icon-btn" id="openAdmin">Admin</div>
        <div class="icon-btn" id="openReport">Monthly Best</div>
        <div class="icon-btn" id="openCartBtn">Cart (<span id="cartCount">0</span>)</div>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="grid">
      <aside class="aside">
        <div class="card">
          <h3>Categories</h3>
          <div class="chip" data-cat="all">All</div>
          <div class="chip" data-cat="rings">Rings</div>
          <div class="chip" data-cat="necklaces">Necklaces</div>
          <div class="chip" data-cat="earrings">Earrings</div>
          <div class="chip" data-cat="bracelets">Bracelets</div>
        </div>

        <div style="height:16px"></div>

        <div class="card">
          <h3>Cart Summary</h3>
          <div id="cartSummary">No items yet.</div>
          <div style="height:12px"></div>
          <button class="btn" id="checkoutBtn">Proceed to Checkout</button>
        </div>
      </aside>

      <section>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
          <h2>Featured</h2>
          <div class="muted">Wear your confidence. Wear your crown.</div>
        </div>

        <div id="products" class="products"></div>
      </section>
    </div>
  </main>

  <!-- Cart drawer -->
  <div id="cartDrawer" class="cart-drawer" aria-hidden="true">
    <h3>Cart</h3>
    <div id="cartItems"></div>
    <div style="margin-top:8px;display:flex;justify-content:space-between;align-items:center">
      <div><strong>Total:</strong> ₱<span id="cartTotal">0</span></div>
      <div><button class="btn" id="buyNow">Buy Now</button></div>
    </div>
  </div>

  <!-- Product modal (quick view) -->
  <div id="modalBackdrop" class="modal-backdrop">
    <div class="modal">
      <div class="content" style="display:grid;grid-template-columns:1fr;gap:12px">
        <div id="modalImage" style="height:320px;background:linear-gradient(180deg,#fff,#fff7f9);display:flex;align-items:center;justify-content:center"></div>
        <div>
          <h3 id="modalTitle"></h3>
          <div class="price" id="modalPrice"></div>
          <div class="meta" id="modalCategory"></div>
          <p id="modalDesc" class="muted"></p>
          <div style="height:12px"></div>
          <div style="display:flex;gap:8px;align-items:center">
            <input id="qty" type="number" value="1" min="1" style="width:80px;padding:8px;border-radius:8px;border:1px solid #eee" />
            <button class="btn" id="addToCartBtn">Add to cart</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Checkout modal -->
  <div id="checkoutModal" class="modal-backdrop" aria-hidden="true">
    <div class="modal">
      <div class="content">
        <h3>Checkout</h3>

        <div id="checkoutItems" style="max-height:220px;overflow:auto;margin-bottom:8px"></div>

        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
          <div>Subtotal</div><div>₱<span id="checkoutSubtotal">0</span></div>
        </div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
          <div>Shipping</div><div>₱<span id="checkoutShipping">50</span></div>
        </div>
        <hr />

        <div class="field">
          <label for="shipName">Full name</label>
          <input id="shipName" type="text" placeholder="Juan dela Cruz"/>
        </div>
        <div class="field">
          <label for="shipPhone">Phone number</label>
          <input id="shipPhone" type="tel" placeholder="09XXXXXXXXX" />
        </div>
        <div class="field">
          <label for="shipAddress">Shipping address</label>
          <textarea id="shipAddress" rows="3" placeholder="House no, street, barangay, city, province, zip"></textarea>
        </div>

        <div class="field">
          <label>Payment method</label>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <label><input name="pay" type="radio" value="cod" checked /> Cash on Delivery</label>
            <label><input name="pay" type="radio" value="gcash" /> GCash (upload + ref #)</label>
            <label><input name="pay" type="radio" value="paymaya" /> PayMaya (upload + ref #)</label>
          </div>
          <div class="small-muted">For GCash / PayMaya please upload the payment screenshot and add the reference number.</div>
        </div>

        <div id="receiptFields" style="display:none">
          <div class="field">
            <label for="payRef">Payment Reference Number</label>
            <input id="payRef" type="text" placeholder="e.g. GCS-12345678 or PayMaya ref" />
          </div>
          <div class="field">
            <label for="receiptFile">Upload payment screenshot</label>
            <input id="receiptFile" type="file" accept="image/*"/>
            <img id="receiptPreview" class="receipt-preview" style="display:none" alt="receipt preview" />
          </div>
        </div>

        <div id="checkoutMsg" class="muted small-muted" style="margin-bottom:8px"></div>

        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <button class="btn" id="submitCheckout">Place Order</button>
          <button class="chip" id="cancelCheckout">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Admin modal -->
 <h2>Admin — Orders</h2>
<div>
  <button id="refreshOrders">Refresh</button>
  <button id="clearOrders">Clear All Orders</button>
</div>
<div id="adminOrdersList"></div>

<div>
  <h3>Export / Import</h3>
  <button id="exportOrders">Export JSON</button>
  <input type="file" id="importOrdersFile"/>
</div>

  <!-- Report modal -->
  <div id="reportModal" class="modal-backdrop">
    <div class="modal">
      <div class="content">
        <h3>Monthly Best Sellers</h3>
        <div style="display:flex;gap:8px;align-items:center;margin-bottom:12px">
          <label>Choose month</label>
          <input id="reportMonth" type="month" />
        </div>
        <div id="reportContent"></div>
        <div style="height:12px"></div>
        <button class="chip" id="closeReport">Close</button>
      </div>
    </div>
  </div>

  <footer>
    <div class="container">
      <div style="font-weight:700">Five Queens Jewelry</div>
      <div class="muted">Demo storefront — orders & receipts stored in browser localStorage for demo/admin use.</div>
    </div>
  </footer>

  <script>
    // ---------- Data ----------
    const demoProducts = [
      {id:'p1',title:'Royal Pearl Necklace',price:2599,cat:'necklaces',desc:'Freshwater pearl necklace with rose-gold plating.',img:'royal-pearl-necklace.jpg'},
      {id:'p2',title:'Queens Halo Ring',price:1899,cat:'rings',desc:'Cubic zirconia halo ring inspired by royal crowns.',img:'queens-halo-ring.png'},
      {id:'p3',title:'Luxe Pearl Studs',price:799,cat:'earrings',desc:'Minimal pearl studs with secure backs.',img:'luxe-pearl-studs.png'},
      {id:'p4',title:'Rose Gold Bangle',price:1299,cat:'bracelets',desc:'Slim bangle with hammered finish.',img:'rose-gold-bangle.png'},
      {id:'p5',title:'Emerald Drop Earrings',price:2199,cat:'earrings',desc:'Emerald-simulated drop earrings for evening wear.',img:'emerald-drop-earrings.png'},
      {id:'p6',title:'Silver Minimalist Ring',price:699,cat:'rings',desc:'Everyday silver band, polished finish.',img:'silver-minimalist-ring.png'},
      {id:'p7',title:'Amethyst Pendant',price:1499,cat:'necklaces',desc:'Purple amethyst pendant on delicate chain.',img:'amethyst-pendant.jpg'},
      {id:'p8',title:'Stackable Ring Set',price:1199,cat:'rings',desc:'Three stackable rings in mixed metals.',img:'stackable-ring-set.png'},
    ];

    const KEY_PRODUCTS = 'fq_products_v1';
    const KEY_ORDERS = 'fq_orders_v1';
    const KEY_MONTH = 'fq_month_sales_v1';
    const KEY_CART = 'fq_cart_demo_v1';

    if(!localStorage.getItem(KEY_PRODUCTS)) localStorage.setItem(KEY_PRODUCTS, JSON.stringify(demoProducts));
    if(!localStorage.getItem(KEY_ORDERS)) localStorage.setItem(KEY_ORDERS, JSON.stringify([]));
    if(!localStorage.getItem(KEY_MONTH)) localStorage.setItem(KEY_MONTH, JSON.stringify({}));
    if(!localStorage.getItem(KEY_CART)) localStorage.setItem(KEY_CART, JSON.stringify({}));

    let dataProducts = JSON.parse(localStorage.getItem(KEY_PRODUCTS));
    let orders = JSON.parse(localStorage.getItem(KEY_ORDERS));
    let monthSales = JSON.parse(localStorage.getItem(KEY_MONTH));
    let cart = JSON.parse(localStorage.getItem(KEY_CART));
    let currentProduct = null;

    const productsEl = document.getElementById('products');
    const cartCount = document.getElementById('cartCount');
    const cartDrawer = document.getElementById('cartDrawer');
    const cartItemsEl = document.getElementById('cartItems');
    const cartTotalEl = document.getElementById('cartTotal');

    // ---------- Render Products ----------
    function renderProducts(filter='all',search=''){
      productsEl.innerHTML='';
      const q = search.trim().toLowerCase();
      dataProducts.filter(p=>{
        if(filter!=='all' && p.cat!==filter) return false;
        if(q && !(p.title.toLowerCase().includes(q) || p.desc.toLowerCase().includes(q))) return false;
        return true;
      }).forEach(p=>{
        const div = document.createElement('div');
        div.className='product';
        div.innerHTML=`
          <div class="image"><img src="${p.img}" alt="${p.title}" style="max-width:100%;max-height:100%;object-fit:contain"></div>
          <div class="body">
            <div style="font-weight:600">${p.title}</div>
            <div class="price">₱${p.price}</div>
            <div class="meta">${p.cat}</div>
            <div style="height:8px"></div>
            <button class="btn" onclick="openProductModal('${p.id}')">Add to Cart</button>
          </div>
        `;
        productsEl.appendChild(div);
      });
    }

    renderProducts();

    // ---------- Search ----------
    document.getElementById('searchInput').addEventListener('input',e=>{
      renderProducts('all',e.target.value);
    });

    // ---------- Categories ----------
    document.querySelectorAll('.chip').forEach(chip=>{
      chip.addEventListener('click',()=>{
        document.querySelectorAll('.chip').forEach(c=>c.style.borderColor='#eee');
        chip.style.borderColor='var(--accent)';
        renderProducts(chip.dataset.cat, document.getElementById('searchInput').value);
      });
    });

    // ---------- Cart ----------
    function updateCartUI(){
      let total=0; cartItemsEl.innerHTML='';
      const keys = Object.keys(cart);
      if(keys.length===0) cartItemsEl.innerHTML='<div>No items in cart</div>';
      keys.forEach(pid=>{
        const item = cart[pid];
        const div = document.createElement('div');
        div.className='cart-item';
        div.innerHTML=`<div>${item.title} x ${item.qty}</div>
        <div>₱${item.price*item.qty}</div>
        <button class="chip btn-sm" onclick="removeFromCart('${pid}')">Remove</button>`;
        cartItemsEl.appendChild(div);
        total += item.price*item.qty;
      });
      cartTotalEl.innerText=total;
      cartCount.innerText=keys.length;
      localStorage.setItem(KEY_CART, JSON.stringify(cart));
    }

    function openCart(){ cartDrawer.style.display='block'; updateCartUI(); }
    function closeCart(){ cartDrawer.style.display='none'; }
    document.getElementById('openCartBtn').addEventListener('click',openCart);

    function addToCart(p,qty){
      if(cart[p.id]) cart[p.id].qty += qty;
      else cart[p.id] = {...p, qty};
      updateCartUI();
    }

    function removeFromCart(pid){ delete cart[pid]; updateCartUI(); }

    // ---------- Product Modal ----------
    const modalBackdrop = document.getElementById('modalBackdrop');
    const modalTitle = document.getElementById('modalTitle');
    const modalPrice = document.getElementById('modalPrice');
    const modalCategory = document.getElementById('modalCategory');
    const modalDesc = document.getElementById('modalDesc');
    const modalImage = document.getElementById('modalImage');
    const addToCartBtn = document.getElementById('addToCartBtn');
    const qtyInput = document.getElementById('qty');

    function openProductModal(pid){
      currentProduct = dataProducts.find(p=>p.id===pid);
      if(!currentProduct) return;
      modalTitle.innerText = currentProduct.title;
      modalPrice.innerText = '₱'+currentProduct.price;
      modalCategory.innerText = currentProduct.cat;
      modalDesc.innerText = currentProduct.desc;
      modalImage.innerHTML = `<img src="${currentProduct.img}" alt="${currentProduct.title}" style="max-width:100%;max-height:100%;object-fit:contain">`;
      qtyInput.value=1;
      modalBackdrop.style.display='flex';
    }

    addToCartBtn.addEventListener('click',()=>{
      addToCart(currentProduct, parseInt(qtyInput.value)||1);
      modalBackdrop.style.display='none';
    });

    modalBackdrop.addEventListener('click',e=>{if(e.target===modalBackdrop) modalBackdrop.style.display='none';});

    // ---------- Checkout ----------
    const checkoutModal = document.getElementById('checkoutModal');
    const checkoutItems = document.getElementById('checkoutItems');
    const checkoutSubtotal = document.getElementById('checkoutSubtotal');
    const checkoutShipping = document.getElementById('checkoutShipping');
    const shipName = document.getElementById('shipName');
    const shipPhone = document.getElementById('shipPhone');
    const shipAddress = document.getElementById('shipAddress');
    const receiptFields = document.getElementById('receiptFields');
    const receiptFile = document.getElementById('receiptFile');
    const receiptPreview = document.getElementById('receiptPreview');
    const payRef = document.getElementById('payRef');
    const checkoutMsg = document.getElementById('checkoutMsg');

    document.getElementById('checkoutBtn').addEventListener('click',()=>{
      if(Object.keys(cart).length===0){ alert('Cart empty'); return; }
      checkoutModal.style.display='flex'; renderCheckoutItems();
    });

    function renderCheckoutItems(){
      checkoutItems.innerHTML=''; let subtotal=0;
      Object.values(cart).forEach(it=>{
        const div = document.createElement('div');
        div.className='order-row';
        div.innerHTML=`<div>${it.title} x ${it.qty}</div><div>₱${it.price*it.qty}</div>`;
        checkoutItems.appendChild(div);
        subtotal+=it.price*it.qty;
      });
      checkoutSubtotal.innerText=subtotal;
    }

    // Payment option show/hide
    document.querySelectorAll('input[name="pay"]').forEach(inp=>{
      inp.addEventListener('change',()=>{
        receiptFields.style.display=(inp.value==='gcash'||inp.value==='paymaya')?'block':'none';
      });
    });

    receiptFile.addEventListener('change',e=>{
      const f = e.target.files[0];
      if(!f) return receiptPreview.style.display='none';
      const reader = new FileReader();
      reader.onload = ()=>{ receiptPreview.src = reader.result; receiptPreview.style.display='block'; }
      reader.readAsDataURL(f);
    });

    document.getElementById('cancelCheckout').addEventListener('click',()=>{checkoutModal.style.display='none'; checkoutMsg.innerText='';});

    document.getElementById('submitCheckout').addEventListener('click',()=>{
      const name=shipName.value.trim(),phone=shipPhone.value.trim(),addr=shipAddress.value.trim();
      const pay=document.querySelector('input[name="pay"]:checked').value;
      if(!name||!phone||!addr){ checkoutMsg.innerText='Please fill in all shipping info'; return; }

      const order={id:'o'+Date.now(),items:cart,subtotal:parseInt(checkoutSubtotal.innerText),shipping:parseInt(checkoutShipping.innerText),total:parseInt(checkoutSubtotal.innerText)+parseInt(checkoutShipping.innerText),name,phone,addr,pay,status:'pending',date:new Date().toISOString(),receipt:''};

      if(pay==='gcash'||pay==='paymaya'){
        if(!payRef.value.trim()||!receiptFile.files[0]){ checkoutMsg.innerText='Please upload receipt and enter reference number'; return; }
        order.ref = payRef.value.trim();
        const reader = new FileReader();
        reader.onload = ()=>{ order.receipt = reader.result; finalizeOrder(order); };
        reader.readAsDataURL(receiptFile.files[0]);
      } else finalizeOrder(order);
    });

    function finalizeOrder(order){
      orders.push(order); localStorage.setItem(KEY_ORDERS,JSON.stringify(orders));
      // Update monthly sales
      const m = new Date().toISOString().slice(0,7);
      if(!monthSales[m]) monthSales[m]={};
      Object.values(order.items).forEach(it=>{ monthSales[m][it.title]=(monthSales[m][it.title]||0)+it.qty; });
      localStorage.setItem(KEY_MONTH,JSON.stringify(monthSales));
      // Clear cart
      cart={}; localStorage.setItem(KEY_CART,JSON.stringify(cart));
      checkoutModal.style.display='none'; checkoutMsg.innerText=''; updateCartUI();
      alert('Order placed successfully!');
    }



    // ---------- Admin ----------
    
    const adminOrdersList = document.getElementById('adminOrdersList');
    const refreshOrdersBtn = document.getElementById('refreshOrders');
    const clearOrdersBtn = document.getElementById('clearOrders');
    const exportOrdersBtn = document.getElementById('exportOrders');
    const importOrdersFile = document.getElementById('importOrdersFile');
    const adminModal = document.querySelector('h2 + div'); // selects the Admin — Orders section
    adminModal.style.display = 'none'; // hide initially


function getStatusColor(status) {
  switch(status){
    case 'pending': return '#fff8b3'; // yellow
    case 'paid': return '#b3d9ff';    // blue
    case 'delivered': return '#b3ffb3'; // green
    default: return '#f9f9f9';
  }
}

function renderAdminOrders(){
  adminOrdersList.innerHTML = '';
  if(orders.length === 0){
    adminOrdersList.innerHTML = '<div>No orders yet</div>';
    return;
  }

  orders.forEach((o, idx) => {
    const div = document.createElement('div');
    div.className = 'card';
    div.style.border = '1px solid #ccc';
    div.style.padding = '10px';
    div.style.margin = '8px 0';
    div.style.backgroundColor = getStatusColor(o.status);

    // Safe mapping of items
    const itemsText = Object.values(o.items || {}).map(i => `${i.title || ''} x ${i.qty || 0}`).join(', ');

    // Status dropdown
    const statusSelect = document.createElement('select');
    ['pending','paid','delivered'].forEach(s=>{
      const opt = document.createElement('option');
      opt.value = s;
      opt.text = s.charAt(0).toUpperCase() + s.slice(1);
      if(o.status === s) opt.selected = true;
      statusSelect.appendChild(opt);
    });
    statusSelect.addEventListener('change', e => {
      o.status = e.target.value;
      localStorage.setItem(KEY_ORDERS, JSON.stringify(orders));
      renderAdminOrders();
    });

    div.innerHTML = `
      <div><strong>${o.name || ''}</strong> — ${o.date || ''}</div>
      <div class="small-muted">Phone: ${o.phone || ''} | Address: ${o.addr || ''}</div>
      <div class="small-muted">Items: ${itemsText}</div>
      <div class="small-muted">Payment: ${o.pay || ''} ${o.ref || ''}</div>
      <div>Status: </div>
    `;
    div.querySelector('div:last-child').appendChild(statusSelect);
    adminOrdersList.appendChild(div);
  });
}

// Buttons
refreshOrdersBtn.addEventListener('click', renderAdminOrders);

clearOrdersBtn.addEventListener('click', () => {
  if(confirm('Clear all orders?')){
    orders = [];
    localStorage.setItem(KEY_ORDERS, JSON.stringify(orders));
    renderAdminOrders();
  }
});

// Export
exportOrdersBtn.addEventListener('click', () => {
  const blob = new Blob([JSON.stringify(orders, null, 2)], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'orders.json';
  a.click();
  URL.revokeObjectURL(url);
});

// Import
importOrdersFile.addEventListener('change', e => {
  const file = e.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = event => {
    try {
      const imported = JSON.parse(event.target.result);
      if(Array.isArray(imported)){
        orders = imported;
        localStorage.setItem(KEY_ORDERS, JSON.stringify(orders));
        renderAdminOrders();
      } else {
        alert('Invalid JSON file');
      }
    } catch(err){
      alert('Error reading JSON file');
    }
  };
  reader.readAsText(file);
});

// Initial render
renderAdminOrders();
    

    // ---------- Monthly Report ----------
    const reportModal = document.getElementById('reportModal');
    const reportContent = document.getElementById('reportContent');
    document.getElementById('openReport').addEventListener('click',()=>{ reportModal.style.display='flex'; renderReport(); });
    document.getElementById('closeReport').addEventListener('click',()=>{ reportModal.style.display='none'; });

    function renderReport(month){
      const m = month || document.getElementById('reportMonth').value || new Date().toISOString().slice(0,7);
      reportContent.innerHTML='';
      if(!monthSales[m]) reportContent.innerHTML='<div>No sales this month</div>';
      else {
        const list = Object.entries(monthSales[m]).sort((a,b)=>b[1]-a[1]);
        list.forEach(([title,qty])=>{
          const div = document.createElement('div'); div.className='order-row';
          div.innerHTML=`<div>${title}</div><div>Sold: ${qty}</div>`;
          reportContent.appendChild(div);
        });
      }
    }

    document.getElementById('reportMonth').addEventListener('change',()=>{ renderReport(document.getElementById('reportMonth').value); });

    // Initial cart UI
    updateCartUI();
  </script>
</body>
</html>
